(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{U73M:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var o=n("xpyy");class i extends o.a{constructor(t){super(t)}get contato(){let t=[];if(this.fone){var e=this.fone.replace(/^(\d{2})(\d{5})(\d{4}).*/,"($1) $2-$3");t.push(e)}return this.email&&t.push(this.email),t.join(", ")}}},VzdP:function(t,e,n){"use strict";n.d(e,"a",function(){return u});var o=n("mrSG"),i=n("WSGN"),r=n("fXoL"),s=n("U73M"),a=n("fb0m");let c=(()=>{class t{constructor(){}setValue(t,e){let n=e?JSON.stringify(e):e;localStorage.setItem(t,n)}getValue(t){let e=localStorage.getItem(t);return e?JSON.parse(e):e}get escolaId(){let t=this.getValue("escolaId")||1;return this.setValue("escolaId",t+1),t}get turmaId(){let t=this.getValue("turmaId")||1;return this.setValue("turmaId",t+1),t}get alunoId(){let t=this.getValue("alunoId")||1;return this.setValue("alunoId",t+1),t}remove(t){return localStorage.removeItem(t)}getAlunos(){return(this.getValue("alunos")||[]).map(t=>new s.a(t))}getAluno(t){return this.getAlunos().find(e=>e.id==t)}populate(){let t=[],e=[],n=[],o=1,r=1,c=1;console.log("Polulando base de dados");for(let u=1;u<=10;u++,o++){let l=new i.a;l.id=o+"",l.nome=`Escola #${u}`,l.cep="18278000",l.estado="SP",l.cidade="Tatu\xed",l.bairro="Vila Nova Esperan\xe7a",l.logradouro="Rua Ant\xf4nio Henrique da Silva "+u,l.numero=635,l.complemento="",l.fone="(15) 325"+u+"-3996",l.email=`escola_${u}@email.edu.br`,l.ativa=Math.random()<.5,t.push(l);for(let t=1;t<8;t++,r++){let o=new a.a;o.id=r+"",o.ativa=Math.random()<.5,o.numero=t+"",o.escolaId=l.id,o.serie=t+1,e.push(o);for(let e=1;e<20;e++,c++){let i=new s.a;i.id=c+"",i.nome="Aluno #"+e+"  da Turma #"+t,i.matricula=Math.floor(1e9*Math.random())+"",i.cpf="184.118.870-06",i.logradouro="Rua X",i.numero=32,i.bairro=l.bairro,i.cidade=l.cidade,i.estado=l.estado,i.cep=l.cep,i.complemento="",i.fone="(15) 325"+e+"-3996",i.email=`aluno_${e}@email.edu.br`,i.serie=o.serie,i.turmaId=o.id,i.escolaId=l.id,n.push(i)}}}this.setValue("escolaId",o),this.setValue("turmaId",r),this.setValue("alunoid",c),this.setValue("escolas",t),this.setValue("turmas",e),this.setValue("alunos",n),console.log("Conlu\xeddo")}salvaAluno(t){let e=this.getAlunos();if(t.id){let n=e.find(e=>e.id==t.id);n?n.deserialize(t):e.push(t)}else t.id=this.alunoId,e.push(t);return this.setValue("alunos",e),t}getEscolas(){return this.getValue("escolas"),(this.getValue("escolas")||[]).map(t=>new i.a(t))}getEscola(t){return this.getEscolas().find(e=>e.id==t)}salvaEscola(t){let e=this.getEscolas();if(t.id){let n=e.find(e=>e.id==t.id);n?n.deserialize(t):e.push(t)}else t.id=this.escolaId,e.push(t);return this.setValue("escolas",e),t}getTurmas(){return(this.getValue("turmas")||[]).map(t=>new a.a(t))}getTurma(t){return this.getTurmas().find(e=>e.id==t)}salvaTurma(t){let e=this.getTurmas();if(t.id){let n=e.find(e=>e.id==t.id);n?n.deserialize(t):e.push(t)}else t.id=this.turmaId,e.push(t);return this.setValue("turmas",e),t}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),u=(()=>{class t{constructor(t){this.db=t;let e=this.db.getEscolas();(null==e?void 0:e.length)||this.db.populate()}listaEscolas(){return Object(o.a)(this,void 0,void 0,function*(){return this.db.getEscolas().map(t=>new i.a(t))})}listaTurmas(t){return Object(o.a)(this,void 0,void 0,function*(){if(!t||!t.escolaId)throw new Error("Par\xe2metros inv\xe1lidos");return this.db.getTurmas().filter(e=>e.escolaId==t.escolaId)})}listaAlunos(t){return Object(o.a)(this,void 0,void 0,function*(){if(!t||!t.escolaId||!t.turmaId)throw new Error("Par\xe2metros inv\xe1lidos");return this.db.getAlunos().filter(e=>!(t.escolaId&&t.escolaId!=e.escolaId||t.turmaId&&t.turmaId!=e.turmaId))})}salvaEscola(t){return Object(o.a)(this,void 0,void 0,function*(){return this.db.salvaEscola(t)})}salvaTurma(t){return Object(o.a)(this,void 0,void 0,function*(){return this.db.salvaTurma(t)})}salvaAluno(t){return Object(o.a)(this,void 0,void 0,function*(){return this.db.salvaAluno(t)})}buscaEscola(t){return Object(o.a)(this,void 0,void 0,function*(){let e=this.db.getEscola(t);if(!e)throw new Error("Escola n\xe3o encontrada");let n=this.db.getTurmas().filter(t=>e.id==t.escolaId);return{escola:e,turmas:n}})}buscaTurma(t){return Object(o.a)(this,void 0,void 0,function*(){if(!t)throw new Error("Turma inv\xe1lida");let e=this.db.getTurma(t);if(!e)throw new Error("Turma n\xe3o encontrada");let n=this.db.getAlunos().filter(t=>e.id==t.turmaId);return{escola:this.db.getEscola(e.escolaId),turma:e,alunos:n}})}buscaAluno(t){return Object(o.a)(this,void 0,void 0,function*(){let e=this.db.getAluno(t);if(e)throw new Error("Aluno(a) n\xe3o encontrado(a)");return{escola:this.db.getEscola(e.escolaId),turma:this.db.getTurma(e.turmaId),aluno:e}})}buscaAlunoPorCPF(t){return Object(o.a)(this,void 0,void 0,function*(){let e=this.db.getAlunos().find(e=>(e.cpf||"").replace(/\D/g,"")==(t||"").replace(/\D/g,""));if(!e)throw new Error("Aluno(a) n\xe3o encontrado(a)");return e})}}return t.\u0275fac=function(e){return new(e||t)(r.Wb(c))},t.\u0275prov=r.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},WSGN:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var o=n("xpyy");class i extends o.a{constructor(t){super(t)}get endereco(){let t=[];if(this.logradouro&&t.push(this.logradouro),this.numero&&t.push(this.numero),this.complemento&&t.push(this.complemento),this.cidade&&t.push(this.cidade),this.estado&&t.push(this.estado),this.cep){let e=this.cep.length>5?this.cep.substring(0,5)+"-"+this.cep.substring(5):this.cep;t.push("CEP "+e)}return t.join(", ")}get locationLink(){return"https://maps.google.com/?q='"+this.endereco.replace(/ /g,"+")}get contato(){let t=[];if(this.fone){var e=this.fone.replace(/^(\d{2})(\d{5})(\d{4}).*/,"($1) $2-$3");t.push(e)}return this.email&&t.push(this.email),t.join(", ")}}},fb0m:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var o=n("xpyy");class i extends o.a{constructor(t){super(t)}}},gsCG:function(t,e,n){"use strict";n.r(e),n.d(e,"EscolasPageModule",function(){return v});var o=n("ofXK"),i=n("3Pt+"),r=n("TEn/"),s=n("tyNb"),a=n("mrSG"),c=n("jG7P"),u=n("fXoL"),l=n("VzdP");function d(t,e){1&t&&u.Ob(0,"ion-icon",14)}const h=function(t){return["/escola",t]};function m(t,e){if(1&t&&(u.Sb(0,"ion-item",6),u.Sb(1,"div",7),u.Sb(2,"div",8),u.rc(3),u.Rb(),u.Sb(4,"div",9),u.rc(5),u.Rb(),u.Sb(6,"div",10),u.rc(7),u.Rb(),u.Sb(8,"div",11),u.rc(9),u.Rb(),u.Sb(10,"div",12),u.qc(11,d,1,0,"ion-icon",13),u.Rb(),u.Rb(),u.Rb()),2&t){const t=e.$implicit;u.hc("routerLink",u.jc(6,h,t.id)),u.Cb(3),u.sc(t.nome),u.Cb(2),u.sc(t.endereco),u.Cb(2),u.sc(t.fone),u.Cb(2),u.sc(t.email),u.Cb(2),u.hc("ngIf",t.ativa)}}function g(t,e){if(1&t&&(u.Sb(0,"ion-list"),u.qc(1,m,12,8,"ion-item",5),u.Rb()),2&t){const t=u.ec();u.Cb(1),u.hc("ngForOf",t.escolasFiltradas)}}const f=function(){return["/escola/new"]},b=[{path:"",component:(()=>{class t{constructor(t){this.escolasProvider=t,this.loading=!1,this.textoBusca=""}ionViewDidEnter(){this.carregaEscolas()}carregaEscolas(){return Object(a.a)(this,void 0,void 0,function*(){this.loading=!0,this.error=null;try{this.escolas=yield this.escolasProvider.listaEscolas(),this.filtraEscolas()}catch(t){this.error="Falha ao buscar escolas."}this.loading=!1})}filtraEscolas(){if(this.textoBusca){const t=new c.a(this.escolas,["nome","email","fone"],{caseSensitive:!1});this.escolasFiltradas=t.search(this.textoBusca)}else this.escolasFiltradas=this.escolas}}return t.\u0275fac=function(e){return new(e||t)(u.Nb(l.a))},t.\u0275cmp=u.Hb({type:t,selectors:[["app-escolas"]],decls:12,vars:4,consts:[[1,"ion-padding"],["ion-button","","slot","end","shape","round","fill","clear","type","button","color","dark",1,"ion-margin",3,"routerLink"],["name","add-sharp"],["placeholder","Buscar Escolas",3,"ngModel","ngModelChange","ionChange"],[4,"ngIf"],[3,"routerLink",4,"ngFor","ngForOf"],[3,"routerLink"],[1,"turma","conteudo-item"],[1,"nome"],[1,"endereco"],[1,"fone"],[1,"email"],[1,"ativa"],["name","checkmark-sharp",4,"ngIf"],["name","checkmark-sharp"]],template:function(t,e){1&t&&(u.Sb(0,"ion-header"),u.Sb(1,"ion-toolbar"),u.Sb(2,"ion-title"),u.rc(3,"Escolas"),u.Rb(),u.Rb(),u.Rb(),u.Sb(4,"ion-content",0),u.Sb(5,"ion-toolbar"),u.Sb(6,"ion-title"),u.rc(7,"Escolas"),u.Rb(),u.Sb(8,"ion-button",1),u.Ob(9,"ion-icon",2),u.Rb(),u.Rb(),u.Sb(10,"ion-searchbar",3),u.ac("ngModelChange",function(t){return e.textoBusca=t})("ionChange",function(){return e.filtraEscolas()}),u.Rb(),u.qc(11,g,2,1,"ion-list",4),u.Rb()),2&t&&(u.Cb(8),u.hc("routerLink",u.ic(3,f)),u.Cb(2),u.hc("ngModel",e.textoBusca),u.Cb(1),u.hc("ngIf",e.escolas))},directives:[r.h,r.o,r.n,r.f,r.d,r.t,s.h,r.i,r.m,r.u,i.l,i.o,o.j,r.k,o.i,r.j],styles:[".hoverable[_ngcontent-%COMP%]:hover{background-color:#f3f3f3}.pointable[_ngcontent-%COMP%]{cursor:pointer}.conteudo-item[_ngcontent-%COMP%]{width:100%;display:grid;grid-template-columns:1fr 27px;grid-template-rows:auto auto}.conteudo-item[_ngcontent-%COMP%]   .ativa[_ngcontent-%COMP%], .conteudo-item[_ngcontent-%COMP%]   .busca[_ngcontent-%COMP%], .conteudo-item[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%], .conteudo-item[_ngcontent-%COMP%]   .endereco[_ngcontent-%COMP%], .conteudo-item[_ngcontent-%COMP%]   .fone[_ngcontent-%COMP%], .conteudo-item[_ngcontent-%COMP%]   .nome[_ngcontent-%COMP%]{padding:8px;display:grid;align-items:center}.conteudo-item[_ngcontent-%COMP%]   .nome[_ngcontent-%COMP%]{font-size:larger;font-weight:600}.conteudo-item[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%], .conteudo-item[_ngcontent-%COMP%]   .endereco[_ngcontent-%COMP%], .conteudo-item[_ngcontent-%COMP%]   .fone[_ngcontent-%COMP%], .conteudo-item[_ngcontent-%COMP%]   .nome[_ngcontent-%COMP%]{grid-column:1/2}.conteudo-item[_ngcontent-%COMP%]   .ativa[_ngcontent-%COMP%]{grid-column:2/3;grid-row:1/5}@media (min-width:1200px){.conteudo-item[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr 1fr 1fr 27px;grid-template-rows:auto}.conteudo-item[_ngcontent-%COMP%]   .nome[_ngcontent-%COMP%]{grid-column:1/2}.conteudo-item[_ngcontent-%COMP%]   .endereco[_ngcontent-%COMP%]{grid-column:2/3}.conteudo-item[_ngcontent-%COMP%]   .fone[_ngcontent-%COMP%]{grid-column:3/4}.conteudo-item[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{grid-column:4/5}.conteudo-item[_ngcontent-%COMP%]   .ativa[_ngcontent-%COMP%]{grid-column:5/6;grid-row:1/2}}"]}),t})()}];let p=(()=>{class t{}return t.\u0275mod=u.Lb({type:t}),t.\u0275inj=u.Kb({factory:function(e){return new(e||t)},imports:[[s.i.forChild(b)],s.i]}),t})(),v=(()=>{class t{}return t.\u0275mod=u.Lb({type:t}),t.\u0275inj=u.Kb({factory:function(e){return new(e||t)},imports:[[o.b,i.h,r.p,p]]}),t})()},mrSG:function(t,e,n){"use strict";function o(t,e,n,o){return new(n||(n=Promise))(function(i,r){function s(t){try{c(o.next(t))}catch(e){r(e)}}function a(t){try{c(o.throw(t))}catch(e){r(e)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(s,a)}c((o=o.apply(t,e||[])).next())})}n.d(e,"a",function(){return o})},xpyy:function(t,e,n){"use strict";n.d(e,"a",function(){return o});class o{constructor(t){this.deserialize(t)}serialize(){return JSON.parse(JSON.stringify(this))}deserialize(t){Object.assign(this,t)}}}}]);